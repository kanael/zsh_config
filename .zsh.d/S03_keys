# make backward-delete-char work properly
export WORDCHARS='*?_-.[]~=&;!#%^(){}<>'

quote-current-word () {
        setopt localoptions unset noshwordsplit noksharrays
        local lbuf=$LBUFFER rbuf=$RBUFFER last=$LASTWIDGET
        if [[ $last != $WIDGET ]]
        then
                local oldcontext=$curcontext
                local curcontext="${WIDGET}:${${curcontext:-:::}#*:}"
                zle complete-word
                curcontext=$oldcontext 
        fi
}


autoload -U quote-current-word
zle -N quote-current-word
bindkey "^[OP" quote-current-word



################ KEY BINDING #####################
bindkey '\e[1~' beginning-of-line
bindkey '\e[4~' end-of-line
bindkey '\e[3~' delete-char
bindkey '\e[1;5D' backward-word
bindkey '\e[1;5C' forward-word

# you have to make iTerm send this sequence if you want to use it....
bindkey '\e?' backward-delete-word

bindkey '^G' backward-kill-line
bindkey '^z' undo

eval "insert-cdup () { LBUFFER+='cd ..'; zle accept-line }"
zle -N insert-cdup
bindkey '\e[1;6A' insert-cdup

eval "insert-cycledleft () { zle push-line; LBUFFER='pushd -q +1'; zle accept-line }"
zle -N insert-cycledleft
bindkey "\e[1;6D" insert-cycledleft
eval "insert-cycledright () { zle push-line; LBUFFER='pushd -q -0'; zle accept-line }"
zle -N insert-cycledright
bindkey "\e[1;6C" insert-cycledright

eval "insert-popd () { LBUFFER+='popd'; zle accept-line }"
zle -N insert-popd
bindkey "^P" insert-popd

